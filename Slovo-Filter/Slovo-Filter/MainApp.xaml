<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Slovo_Filter.MainApp"
             xmlns:viewModels="clr-namespace:Slovo_Filter.ViewModel"
             xmlns:models1="clr-namespace:Slovo_Filter_DAL.Models;assembly=Slovo-Filter-DAL"
             x:DataType="viewModels:MainAppViewModel"
             BackgroundColor="White">

    <VerticalStackLayout Padding="10" Spacing="10" BackgroundColor="Black">

        <!-- User selection list -->
        <Label Text="Select a User" FontSize="Medium" FontAttributes="Bold" TextColor="Aqua"/>
        <Picker ItemsSource="{Binding Users}" 
                SelectedItem="{Binding SelectedUser, Mode=TwoWay}" 
                ItemDisplayBinding="{Binding FirstName}" />

        <!-- Loading indicator -->
        <ActivityIndicator IsRunning="{Binding isLoading}" IsVisible="{Binding isLoading}" />
        <!-- Message history -->
        <ListView ItemsSource="{Binding MessageHistory}" HeightRequest="300" BackgroundColor="White">
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="models1:Message">
                    <ViewCell>
                        <Frame Padding="10" CornerRadius="8" BackgroundColor="White">
                            <VerticalStackLayout>
                                <Label Text="{Binding Content}" TextColor="Black" LineBreakMode="WordWrap" />
                                <Label Text="{Binding Date, StringFormat='{0:g}'}" 
                                       FontSize="Small" TextColor="Black" />
                            </VerticalStackLayout>
                        </Frame>
                    </ViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Message input -->
        <HorizontalStackLayout Spacing="5">
            <Entry Text="{Binding CurrentMessage}" 
                   Placeholder="Type a message..." 
                   HorizontalOptions="FillAndExpand" />
            <Button Text="Send" Command="{Binding SendMessageCommand}" />
        </HorizontalStackLayout>

    </VerticalStackLayout>

</ContentPage>
